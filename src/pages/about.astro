---
import Footer from '../components/Footer.astro';
import Layout from '../layouts/Layout.astro';
import NavBar from '../components/NavBar.astro';
import CTA from '../components/CTA.astro';
import { Astro } from 'astro';

const currentPath = Astro.url.pathname;
---

<Layout title="About - Draft & Build">
    <NavBar currentPath={currentPath} />
    
    <main class="min-h-screen bg-gradient-to-br from-white via-gray-50 to-gray-100">
        {/* Hero Section */}
        <section class="pt-24 sm:pt-32 pb-12 sm:pb-16 px-4">
            <div class="max-w-7xl mx-auto">
                <div class="bg-white/90 backdrop-blur-xl rounded-3xl p-6 sm:p-10 border-2 border-gray-200/50 shadow-2xl hover:shadow-3xl transition-all duration-500 opacity-0 animate-fade-in">
                    <div class="text-center mb-12 sm:mb-16 relative">
                        {/* Title container */}
                        <div class="relative inline-flex flex-col items-center gap-2 sm:gap-4 animate-slide-in-left">
                            <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold text-center relative text-[#004225]">
                                About Us
                            </h1>
                            <div class="h-1 w-32 sm:w-40 bg-[#004225] rounded-full mt-2"></div>
                            <p class="text-base sm:text-lg text-black mt-4">Building Dreams, Delivering Excellence</p>
                        </div>
                    </div>

                    {/* Content Grid */}
                    <div class="grid lg:grid-cols-2 gap-8 lg:gap-12">
                        {/* Left Column - Image */}
                        <div class="relative w-full">
                            <div class="relative mb-6 sm:mb-8 overflow-hidden">
                                <div class="absolute inset-0 bg-[#004225]/20 rounded-[70px_20px_70px_20px] transform rotate-6 group-hover:rotate-3 transition-all duration-500"></div>
                                <img 
                                    src="/AboutUsPageWhoWeAre.jpg" 
                                    alt="Draft & Build Team" 
                                    class="relative z-10 w-full h-[250px] sm:h-[350px] lg:h-[500px] object-cover rounded-[60px_15px_60px_15px] shadow-xl transform -rotate-3 group-hover:rotate-0 transition-all duration-500"
                                    loading="eager"
                                />
                            </div>
                            {/* Decorative elements */}
                            <div class="absolute -bottom-4 -right-4 w-24 h-24 sm:w-32 sm:h-32 bg-[#004225]/5 rounded-full blur-2xl"></div>
                            <div class="absolute -top-4 -left-4 w-24 h-24 sm:w-32 sm:h-32 bg-[#004225]/5 rounded-full blur-2xl"></div>
                        </div>

                        {/* Right Column - Content */}
                        <div class="space-y-6 sm:space-y-8">
                            <div>
                                <h2 class="text-2xl sm:text-3xl font-bold text-[#004225] mb-4">Our Story</h2>
                                <p class="text-base sm:text-lg text-black leading-relaxed">
                                    Draft & Build is a residential building company based in Auckland, dedicated to delivering exceptional craftsmanship and a stress-free building experience. With over 13 years of expertise, we've built a reputation for quality, reliability, and attention to detail.
                                </p>
                                <div class="w-full h-px bg-[#004225]/30 mt-8"></div>
                            </div>

                            <div>
                                <h2 class="text-2xl sm:text-3xl font-bold text-[#004225] mb-4">Our Approach</h2>
                                <p class="text-base sm:text-lg text-black leading-relaxed">
                                    We believe in transparent communication, meticulous planning, and superior execution. Every project is handled with the same level of dedication, whether it's a small renovation or a complete new build.
                                </p>
                                <div class="w-full h-px bg-[#004225]/30 mt-8"></div>
                            </div>

                            <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 sm:gap-6 pt-4 sm:pt-6">
                                <div class="bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow border border-[#004225]/10">
                                    <div class="text-lg sm:text-xl font-bold text-[#004225]">13+</div>
                                    <div class="text-xs sm:text-sm text-black">Years Experience</div>
                                </div>
                                <div class="bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow border border-[#004225]/10">
                                    <div class="text-lg sm:text-xl font-bold text-[#004225]">50+</div>
                                    <div class="text-xs sm:text-sm text-black">Projects Done</div>
                                </div>
                                <div class="bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow border border-[#004225]/10">
                                    <div class="text-lg sm:text-xl font-bold text-[#004225]">100%</div>
                                    <div class="text-xs sm:text-sm text-black">Satisfaction</div>
                                </div>
                                <div class="bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow border border-[#004225]/10">
                                    <div class="text-lg sm:text-xl font-bold text-[#004225]">LBP</div>
                                    <div class="text-xs sm:text-sm text-black">Certified</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Values Section */}
                    <section class="mt-16 sm:mt-24">
                        <h2 class="text-2xl sm:text-3xl font-bold text-center mb-8 sm:mb-12 text-[#004225]">
                            Our Values
                        </h2>
                        <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6 sm:gap-8">
                            {[
                                {
                                    title: "Quality",
                                    description: "We never compromise on quality, using only the finest materials and proven techniques.",
                                    icon: "🏆"
                                },
                                {
                                    title: "Integrity",
                                    description: "Honesty and transparency are at the core of everything we do.",
                                    icon: "🤝"
                                },
                                {
                                    title: "Innovation",
                                    description: "We stay current with the latest building technologies and methods.",
                                    icon: "💡"
                                },
                                {
                                    title: "Reliability",
                                    description: "Count on us to deliver on time and within budget, every time.",
                                    icon: "⭐"
                                }
                            ].map(value => (
                                <div class="bg-white p-6 rounded-2xl shadow-lg hover:shadow-xl transition-shadow border border-[#004225]/10">
                                    <div class="text-3xl sm:text-4xl mb-4">{value.icon}</div>
                                    <h3 class="text-lg sm:text-xl font-bold text-[#004225] mb-2">{value.title}</h3>
                                    <p class="text-sm sm:text-base text-black">{value.description}</p>
                                </div>
                            ))}
                        </div>
                    </section>

                    {/* Service Areas Section */}
                    <section class="mt-16 sm:mt-24">
                        <h2 class="text-2xl sm:text-3xl font-bold text-center mb-8 sm:mb-12 text-[#004225]">
                            Areas We Service
                        </h2>
                        
                        {/* Mobile View - Initial 6 items + Show More */}
                        <div class="block sm:hidden">
                            <div class="grid grid-cols-2 gap-4" id="mobileAreasList">
                                {[
                                    "Auckland City",
                                    "North Shore",
                                    "East Auckland",
                                    "West Auckland",
                                    "South Auckland",
                                    "Rodney District",
                                    "Waitakere",
                                    "Manukau"
                                ].slice(0, 6).map(area => (
                                    <div class="group bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 text-center">
                                        <span class="text-gray-700 text-sm font-medium group-hover:text-[#B22222]">{area}</span>
                                    </div>
                                ))}
                            </div>
                            <div class="hidden" id="mobileAreasListFull">
                                <div class="grid grid-cols-2 gap-4">
                                    {[
                                        "Auckland City",
                                        "North Shore",
                                        "East Auckland",
                                        "West Auckland",
                                        "South Auckland",
                                        "Rodney District",
                                        "Waitakere",
                                        "Manukau"
                                    ].map(area => (
                                        <div class="group bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 text-center">
                                            <span class="text-gray-700 text-sm font-medium group-hover:text-[#B22222]">{area}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            <button id="showMoreBtn" class="mt-6 w-full py-3 px-4 bg-white text-[#B22222] rounded-xl border border-[#B22222] hover:bg-[#B22222] hover:text-white transition-all duration-300">
                                Show More Areas
                            </button>
                        </div>

                        {/* Desktop View - All items in grid */}
                        <div class="hidden sm:grid sm:grid-cols-3 md:grid-cols-4 gap-4 sm:gap-6">
                            {[
                                "Auckland City",
                                "North Shore",
                                "East Auckland",
                                "West Auckland",
                                "South Auckland",
                                "Rodney District",
                                "Waitakere",
                                "Manukau"
                            ].map(area => (
                                <div class="group bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 text-center">
                                    <span class="text-gray-700 text-sm sm:text-base font-medium group-hover:text-[#B22222]">{area}</span>
                                </div>
                            ))}
                        </div>
                    </section>
                </div>
            </div>
        </section>

        <CTA />
    </main>

    <Footer />
</Layout>

<style>
    .shadow-3xl {
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes slideInLeft {
        from {
            opacity: 0;
            transform: translateX(-50px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    @keyframes slideInRight {
        from {
            opacity: 0;
            transform: translateX(50px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .animate-fade-in {
        animation: fadeIn 1s ease-out forwards;
    }

    .animate-slide-in-left {
        opacity: 0;
        animation: slideInLeft 1s ease-out forwards;
        animation-delay: 0.3s;
    }

    .animate-slide-in-right {
        opacity: 0;
        animation: slideInRight 1s ease-out forwards;
        animation-delay: 0.3s;
    }

    /* Additional responsive styles */
    @media (max-width: 640px) {
        .animate-slide-in-left, .animate-slide-in-right {
            animation: fadeIn 1s ease-out forwards;
            animation-delay: 0.3s;
        }
    }

    .animation-delay-2000 {
        animation-delay: 2s;
    }

    .animation-delay-4000 {
        animation-delay: 4s;
    }

    .animation-delay-6000 {
        animation-delay: 6s;
    }

    .scroll-animate-up {
        will-change: transform, opacity;
        opacity: 0;
        transform: translateY(50px);
    }

    .custom-scrollbar {
        scrollbar-width: thin;
        scrollbar-color: #E5E7EB transparent;
    }

    .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
    }

    .custom-scrollbar::-webkit-scrollbar-track {
        background: transparent;
    }

    .custom-scrollbar::-webkit-scrollbar-thumb {
        background-color: #E5E7EB;
        border-radius: 3px;
    }

    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background-color: #D1D5DB;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }

    .delay-100 {
        animation-delay: 100ms;
    }
    .delay-200 {
        animation-delay: 200ms;
    }
    .delay-300 {
        animation-delay: 300ms;
    }
</style>

<script>
    // Force scroll to top immediately when script loads
    if (typeof window !== 'undefined') {
        window.scrollTo(0, 0);
    }

    // Toggle areas list and scroll into view
    const toggleButton = document.getElementById('toggleAreas');
    const arrowIcon = document.getElementById('arrowIcon');
    const allAreas = document.getElementById('allAreas');

    // Function to close dropdown
    const closeDropdown = (shouldScroll = false) => {
        allAreas?.classList.add('hidden');
        arrowIcon?.classList.remove('rotate-180');

        // Only scroll back if explicitly requested (when toggle button is clicked)
        if (shouldScroll) {
            const serviceAreasSection = document.getElementById('serviceAreasSection');
            if (serviceAreasSection) {
                const sectionRect = serviceAreasSection.getBoundingClientRect();
                const scrollPosition = window.pageYOffset + sectionRect.top - 100;
                
                window.scrollTo({
                    top: scrollPosition,
                    behavior: 'smooth'
                });
            }
        }
    };

    // Function to open dropdown and scroll to content
    const openDropdown = () => {
        allAreas?.classList.remove('hidden');
        arrowIcon?.classList.add('rotate-180');

        // Wait for the dropdown to be visible before scrolling
        setTimeout(() => {
            if (allAreas) {
                const dropdownRect = allAreas.getBoundingClientRect();
                const scrollPosition = window.pageYOffset + dropdownRect.top - (window.innerHeight / 2) + (dropdownRect.height / 2);
                
                window.scrollTo({
                    top: scrollPosition,
                    behavior: 'smooth'
                });
            }
        }, 100);
    };

    // Toggle button click handler
    toggleButton?.addEventListener('click', (e) => {
        e.stopPropagation(); // Prevent click from immediately triggering document click
        if (allAreas?.classList.contains('hidden')) {
            openDropdown();
        } else {
            closeDropdown(true); // Pass true to scroll back when toggle button is clicked
        }
    });

    // Click outside to close
    document.addEventListener('click', (e) => {
        if (!allAreas?.contains(e.target as Node) && 
            !toggleButton?.contains(e.target as Node) && 
            !allAreas?.classList.contains('hidden')) {
            closeDropdown(false); // Pass false to prevent scrolling when clicking outside
        }
    });

    // Prevent clicks inside dropdown from closing it
    allAreas?.addEventListener('click', (e) => {
        e.stopPropagation();
    });

    // Close on escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !allAreas?.classList.contains('hidden')) {
            closeDropdown(false); // Pass false to prevent scrolling when using escape key
        }
    });

    // Scroll animation
    let lastScrollTop = 0;
    let isScrollingDown = true;

    // Update scroll direction
    window.addEventListener('scroll', () => {
        const currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
        isScrollingDown = currentScrollTop > lastScrollTop;
        lastScrollTop = currentScrollTop;
    });

    // Scroll animation for content sections
    const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            const element = entry.target as HTMLElement;
            
            if (entry.isIntersecting) {
                // Only animate if we're scrolling and not on initial page load
                if (lastScrollTop > 0) {
                    element.style.animation = 'slideUp 0.8s ease-out forwards';
                } else {
                    // On initial load, just show the element without animation
                    element.style.opacity = '1';
                    element.style.transform = 'translateY(0)';
                }
            } else if (!entry.isIntersecting && !isScrollingDown) {
                // Reset only when scrolling up and element is out of view
                element.style.animation = 'none';
                element.style.opacity = '0';
                element.style.transform = 'translateY(50px)';
            }
        });
    }, observerOptions);

    // Start observing all elements with scroll-animate-up class
    document.addEventListener('DOMContentLoaded', () => {
        // Select the outer div that contains the gradient border
        const sections = document.querySelectorAll('.mb-16 > div');
        sections.forEach((section, index) => {
            // Skip the first section (hero)
            if (index > 0) {
                const element = section as HTMLElement;
                element.classList.add('scroll-animate-up');
                element.style.transition = 'transform 0.8s ease-out, opacity 0.8s ease-out';
                observer.observe(element);
            }
        });

        // Also observe CTA and footer
        const additionalSections = document.querySelectorAll('.py-16, footer');
        additionalSections.forEach(section => {
            const element = section as HTMLElement;
            element.classList.add('scroll-animate-up');
            element.style.transition = 'transform 0.8s ease-out, opacity 0.8s ease-out';
            observer.observe(element);
        });

        const showMoreBtn = document.getElementById('showMoreBtn');
        const mobileAreasList = document.getElementById('mobileAreasList');
        const mobileAreasListFull = document.getElementById('mobileAreasListFull');

        if (showMoreBtn && mobileAreasList && mobileAreasListFull) {
            showMoreBtn.addEventListener('click', () => {
                mobileAreasList.style.display = 'none';
                mobileAreasListFull.style.display = 'block';
                showMoreBtn.style.display = 'none';
            });
        }
    });
</script> 