---
import Footer from '../components/Footer.astro';
import Layout from '../layouts/Layout.astro';
import NavBar from '../components/NavBar.astro';
import CTA from '../components/CTA.astro';

const currentPath = Astro.url.pathname;
---

<Layout title="Services - Draft & Build">
    <NavBar currentPath={currentPath} />
    
    <main class="min-h-screen bg-gradient-to-br from-white via-gray-50 to-gray-100">
        {/* Hero Section */}
        <section class="pt-32 pb-16 px-4">
            <div class="max-w-7xl mx-auto">
                <div class="bg-white/90 backdrop-blur-xl rounded-3xl p-10 border-2 border-gray-200/50 shadow-2xl hover:shadow-3xl transition-all duration-500">
                    <div class="text-center mb-16 relative">
                        {/* Background accent */}
                        <div class="absolute inset-x-0 top-1/2 -translate-y-1/2 h-[150%] bg-gradient-to-r from-[#B22222]/5 via-white to-[#330000]/5"></div>
                        
                        {/* Title container */}
                        <div class="relative inline-flex items-center">
                            {/* Left decorative element */}
                            <div class="absolute -left-12 top-1/2 -translate-y-1/2">
                                <div class="w-8 h-[2px] bg-gradient-to-r from-[#B22222] to-transparent"></div>
                                <div class="w-6 h-[2px] bg-gradient-to-r from-[#B22222]/50 to-transparent mt-1"></div>
                                <div class="w-4 h-[2px] bg-gradient-to-r from-[#B22222]/20 to-transparent mt-1"></div>
                            </div>

                            {/* Title */}
                            <h1 class="text-5xl font-bold px-16">
                                <span class="relative">
                                    <span class="bg-clip-text text-transparent bg-gradient-to-r from-[#330000] to-[#330000]/90">Our</span>
                                    <div class="absolute -bottom-2 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-[#330000]/20 to-transparent"></div>
                                </span>
                                <span class="relative ml-3">
                                    <span class="bg-clip-text text-transparent bg-gradient-to-r from-[#B22222] to-[#B22222]/90">Services</span>
                                    <div class="absolute -bottom-2 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-[#B22222]/20 to-transparent"></div>
                                </span>
                            </h1>

                            {/* Right decorative element */}
                            <div class="absolute -right-12 top-1/2 -translate-y-1/2">
                                <div class="w-8 h-[2px] bg-gradient-to-l from-[#B22222] to-transparent"></div>
                                <div class="w-6 h-[2px] bg-gradient-to-l from-[#B22222]/50 to-transparent mt-1"></div>
                                <div class="w-4 h-[2px] bg-gradient-to-l from-[#B22222]/20 to-transparent mt-1"></div>
                            </div>
                        </div>

                        {/* Subtitle with animated underline */}
                        <div class="relative mt-6">
                            <p class="text-gray-600 text-lg">Crafting Excellence in Every Project</p>
                            <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-24 h-[1px] bg-gradient-to-r from-transparent via-[#B22222]/30 to-transparent"></div>
                        </div>
                    </div>

                    {/* Service Cards */}
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        {/* New Builds */}
                        <div class="group bg-white rounded-2xl p-10 border-2 border-gray-100 shadow-lg hover:shadow-xl transition-all duration-500 hover:border-[#B22222]/30">
                            <div class="relative mb-8 overflow-hidden">
                                <div class="absolute inset-0 bg-gradient-to-br from-[#B22222]/20 to-[#330000]/20 rounded-[70px_20px_70px_20px] transform rotate-6 group-hover:rotate-3 transition-all duration-500"></div>
                                <img 
                                    src="/NewBuildServices.jpeg" 
                                    alt="New Build Services" 
                                    class="relative z-10 w-full h-[300px] object-cover rounded-[60px_15px_60px_15px] shadow-xl transform -rotate-3 group-hover:rotate-0 transition-all duration-500"
                                />
                                <div class="absolute inset-0 bg-gradient-to-tr from-[#B22222]/10 to-transparent rounded-[60px_15px_60px_15px] mix-blend-overlay"></div>
                            </div>
                            <div class="text-[#B22222] transform group-hover:scale-110 group-hover:rotate-6 transition-all duration-500 flex justify-center mb-6">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                                </svg>
                            </div>
                            <div class="text-center">
                                <h3 class="text-3xl font-bold mb-4 text-[#330000] group-hover:text-[#B22222] transition-colors duration-300">New Builds</h3>
                                <p class="text-gray-600 mb-8 leading-relaxed text-lg">Create your dream home from the ground up. Our experienced team handles everything from initial design to final construction, ensuring quality and excellence at every step.</p>
                                <a href="/contact" class="inline-flex items-center px-10 py-4 text-lg font-medium text-white bg-[#330000] hover:bg-[#B22222] rounded-2xl transition-all duration-300 shadow-lg hover:shadow-xl hover:shadow-[#B22222]/20 transform hover:-translate-y-1">
                                    <span class="relative z-10">Get Started</span>
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2 relative z-10" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                                    </svg>
                                </a>
                            </div>
                        </div>

                        {/* Renovations */}
                        <div class="group bg-white rounded-2xl p-10 border-2 border-gray-100 shadow-lg hover:shadow-xl transition-all duration-500 hover:border-[#B22222]/30">
                            <div class="relative mb-8 overflow-hidden">
                                <div class="absolute inset-0 bg-gradient-to-bl from-[#B22222]/20 to-[#330000]/20 rounded-[20px_70px_20px_70px] transform -rotate-6 group-hover:-rotate-3 transition-all duration-500"></div>
                                <img 
                                    src="/RenovationsServicesPage.jpg" 
                                    alt="Renovation Services" 
                                    class="relative z-10 w-full h-[300px] object-cover rounded-[15px_60px_15px_60px] shadow-xl transform rotate-3 group-hover:rotate-0 transition-all duration-500"
                                />
                                <div class="absolute inset-0 bg-gradient-to-tl from-[#B22222]/10 to-transparent rounded-[15px_60px_15px_60px] mix-blend-overlay"></div>
                            </div>
                            <div class="text-[#B22222] transform group-hover:scale-110 group-hover:rotate-6 transition-all duration-500 flex justify-center mb-6">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                                </svg>
                            </div>
                            <div class="text-center">
                                <h3 class="text-3xl font-bold mb-4 text-[#330000] group-hover:text-[#B22222] transition-colors duration-300">Renovations</h3>
                                <p class="text-gray-600 mb-8 leading-relaxed text-lg">Transform your existing space into something extraordinary. Our renovation services blend modern design with practical functionality, creating spaces that inspire.</p>
                                <a href="/contact" class="inline-flex items-center px-10 py-4 text-lg font-medium text-white bg-[#330000] hover:bg-[#B22222] rounded-2xl transition-all duration-300 shadow-lg hover:shadow-xl hover:shadow-[#B22222]/20 transform hover:-translate-y-1">
                                    <span class="relative z-10">Get Started</span>
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2 relative z-10" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                                    </svg>
                                </a>
                            </div>
                        </div>
                    </div>

                    {/* Specialised Services Section */}
                    <section class="py-16">
                        <div class="bg-white/90 backdrop-blur-xl rounded-3xl p-10 border-2 border-gray-200/50 shadow-2xl">
                            <h2 class="text-5xl font-bold mb-16 text-center">
                                <span class="bg-clip-text text-transparent bg-gradient-to-r from-[#330000] to-[#330000]/90">Specialised</span>
                                <span class="bg-clip-text text-transparent bg-gradient-to-r from-[#B22222] to-[#B22222]/90 ml-4">Services</span>
                            </h2>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                                {[
                                    { name: "Kitchen Remodeling", desc: "Modern kitchen solutions", icon: "ðŸ " },
                                    { name: "Bathroom Renovations", desc: "Luxury bathroom designs", icon: "ðŸ›" },
                                    { name: "Window Installation", desc: "Quality installations", icon: "ðŸªŸ" },
                                    { name: "Roofing Services", desc: "Complete solutions", icon: "ðŸ¡" },
                                    { name: "Flooring", desc: "Premium options", icon: "ðŸ”¨" },
                                    { name: "Insulation", desc: "Energy-efficient", icon: "â„ï¸" },
                                    { name: "Foundation", desc: "Structural integrity", icon: "ðŸ—ï¸" },
                                    { name: "Electrical", desc: "Licensed experts", icon: "âš¡" }
                                ].map((service) => (
                                    <div class="group bg-white rounded-2xl p-8 border-2 border-gray-100 shadow-xl hover:shadow-2xl transition-all duration-500 hover:border-[#B22222]/30 transform hover:-translate-y-1">
                                        <div class="relative overflow-hidden text-center">
                                            <span class="text-5xl mb-6 block transform group-hover:scale-125 transition-transform duration-300">{service.icon}</span>
                                            <h3 class="text-xl font-bold mb-3 text-[#330000] group-hover:text-[#B22222] transition-colors duration-300">{service.name}</h3>
                                            <p class="text-gray-600">{service.desc}</p>
                                            <div class="absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-[#B22222] to-[#330000] transform scale-x-0 group-hover:scale-x-100 transition-transform duration-500"></div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </section>

                    {/* Categories Section */}
                    <section class="py-16">
                        <div class="bg-white/90 backdrop-blur-xl rounded-3xl p-10 border-2 border-gray-200/50 shadow-2xl">
                            <div class="text-center mb-12">
                                <h2 class="text-5xl font-bold mb-6">
                                    <span class="bg-clip-text text-transparent bg-gradient-to-r from-[#330000] to-[#330000]/90">Categories</span>
                                    <span class="bg-clip-text text-transparent bg-gradient-to-r from-[#B22222] to-[#B22222]/90 ml-4">We Service</span>
                                </h2>
                                <div class="w-48 h-2 bg-gradient-to-r from-[#330000] via-[#B22222] to-[#330000] mx-auto mb-8 rounded-full"></div>
                                <p class="text-gray-600 mb-12 max-w-3xl mx-auto text-xl font-medium">Browse through our comprehensive list of services.</p>
                            </div>

                            {/* Featured Categories */}
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-16">
                                {/* Roofing */}
                                <div class="group relative transform hover:-translate-y-1 transition-all duration-500">
                                    <div class="absolute inset-0 bg-gradient-to-br from-[#B22222]/20 to-[#330000]/20 
                                        clip-path-custom transform rotate-2 transition-all duration-300 group-hover:rotate-6"></div>
                                    <div class="relative overflow-hidden clip-path-custom shadow-xl h-[300px]">
                                        <img 
                                            src="/Roofing.jpg" 
                                            alt="Roofing Services" 
                                            class="w-full h-full object-cover transform transition-transform duration-500 group-hover:scale-110"
                                        />
                                        <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent">
                                            <div class="absolute bottom-0 left-0 p-6">
                                                <h3 class="text-2xl font-bold text-white mb-2">Roofing</h3>
                                                <p class="text-white/90 text-sm">Expert roofing solutions</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Foundation */}
                                <div class="group relative transform hover:-translate-y-1 transition-all duration-500">
                                    <div class="absolute inset-0 bg-gradient-to-bl from-[#330000]/20 to-[#B22222]/20 
                                        clip-path-custom2 transform -rotate-2 transition-all duration-300 group-hover:-rotate-4"></div>
                                    <div class="relative overflow-hidden clip-path-custom2 shadow-xl h-[300px]">
                                        <img 
                                            src="/Foundation.jpg" 
                                            alt="Foundation Services" 
                                            class="w-full h-full object-cover transform transition-transform duration-500 group-hover:scale-110"
                                        />
                                        <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent">
                                            <div class="absolute bottom-0 left-0 p-6">
                                                <h3 class="text-2xl font-bold text-white mb-2">Foundation</h3>
                                                <p class="text-white/90 text-sm">Solid foundations</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Decking */}
                                <div class="group relative transform hover:-translate-y-1 transition-all duration-500">
                                    <div class="absolute inset-0 bg-gradient-to-tr from-[#B22222]/20 to-[#330000]/20 
                                        clip-path-custom3 transform rotate-1 transition-all duration-300 group-hover:rotate-3"></div>
                                    <div class="relative overflow-hidden clip-path-custom3 shadow-xl h-[300px]">
                                        <img 
                                            src="/Decking.jpg" 
                                            alt="Decking Services" 
                                            class="w-full h-full object-cover transform transition-transform duration-500 group-hover:scale-110"
                                        />
                                        <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent">
                                            <div class="absolute bottom-0 left-0 p-6">
                                                <h3 class="text-2xl font-bold text-white mb-2">Decking</h3>
                                                <p class="text-white/90 text-sm">Beautiful outdoor spaces</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="text-center">
                                <button id="toggleCategories" 
                                    class="group relative inline-flex items-center px-12 py-4 text-lg font-medium
                                    bg-gradient-to-r from-white via-rose-50 to-white
                                    hover:from-rose-50 hover:via-white hover:to-rose-50
                                    border border-rose-100 hover:border-[#B22222]/20
                                    rounded-2xl transition-all duration-500 
                                    shadow-lg hover:shadow-xl">
                                    
                                    {/* Inner glow effect */}
                                    <div class="absolute inset-0 rounded-2xl bg-gradient-to-r from-[#B22222]/5 via-transparent to-[#B22222]/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                                    
                                    {/* Button content */}
                                    <span class="relative text-[#330000] group-hover:text-[#B22222] transition-colors duration-300 mr-3">
                                        View All Categories
                                    </span>
                                    <svg id="arrowIcon" 
                                        xmlns="http://www.w3.org/2000/svg" 
                                        class="h-5 w-5 text-[#B22222] transform transition-all duration-500 group-hover:translate-y-0.5" 
                                        viewBox="0 0 20 20" 
                                        fill="currentColor">
                                        <path fill-rule="evenodd" 
                                            d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" 
                                            clip-rule="evenodd" />
                                    </svg>

                                    {/* Light beam effect */}
                                    <div class="absolute inset-0 -z-10 bg-gradient-to-r from-transparent via-rose-100/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000"></div>
                                </button>
                            </div>

                            <div id="categoriesList" class="hidden mt-8">
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-x-6 gap-y-2 max-h-[600px] overflow-y-auto custom-scrollbar">
                                    {[
                                        "Architects",
                                        "Architects / Building Designers",
                                        "Asbestos Removal",
                                        "Baches and Cottages",
                                        "Balustrade",
                                        "Bars",
                                        "Bathroom Remodelers",
                                        "Builders",
                                        "Building Advice",
                                        "Building Contractors",
                                        "Building Designers",
                                        "Building Maintenance",
                                        "Building Removals & Demolition",
                                        "Building Supplies & Fittings",
                                        "Carpentry Companies",
                                        "Carpentry Contractors / Carpenters",
                                        "Cat doors",
                                        "Cedar Timber Work",
                                        "Cladding",
                                        "Commercial fit-outs",
                                        "Concrete Cutters",
                                        "Construction Companies",
                                        "Construction Project Managers",
                                        "Custom Homes Builders",
                                        "Deck restoration",
                                        "Decks & Decking",
                                        "Demolition",
                                        "Design & Construction",
                                        "Door & Window Installation",
                                        "Drainage",
                                        "Draughting Services",
                                        "Drilling and site preparation",
                                        "Driveways",
                                        "Earthworks & Retaining Walls",
                                        "Excavating & Earthmoving",
                                        "Farm Fencing",
                                        "Fencing Contractors",
                                        "Flashings",
                                        "Floor Repair",
                                        "Flooring Contractors",
                                        "Floors & Carpet",
                                        "Foundation / Repiling Contractors",
                                        "Foundation Contractors",
                                        "Framing Beams",
                                        "Framing Contractor",
                                        "Garden Awnings",
                                        "Handymen Services",
                                        "Hardware & Home Improvement",
                                        "Holiday Homes",
                                        "House & Building Shrink Wrapping",
                                        "House Inspections",
                                        "Insulation Installers",
                                        "Insulation Removal",
                                        "Joinery",
                                        "Kitchen Remodellers",
                                        "Kitset Buildings",
                                        "Land Clearance",
                                        "Landscaping Architects",
                                        "Landscaping Designers",
                                        "Luxury Homes Builders",
                                        "Maintenance & Repair / Renovation",
                                        "Metal roofing",
                                        "Pile Driving & Retaining Walls",
                                        "Piling Services",
                                        "Pool Fencing",
                                        "Pre-sale maintenance",
                                        "Property maintenance",
                                        "Renovation",
                                        "Residential Awnings",
                                        "Roofing",
                                        "Roofing Consultants",
                                        "Roofing Contractors",
                                        "Rubbish / Junk Removal",
                                        "Security fencing",
                                        "Shelters",
                                        "Skylights & Ventilation",
                                        "Timber Flooring",
                                        "Window Installation",
                                        "Window Repairs",
                                        "Windows & Doors",
                                        "Wood Floor Installers"
                                    ].sort().map((category, index, array) => {
                                        const firstLetter = category.charAt(0);
                                        const prevFirstLetter = index > 0 ? array[index - 1].charAt(0) : '';
                                        const isNewLetter = firstLetter !== prevFirstLetter;

                                        return (
                                            <>
                                                {isNewLetter && (
                                                    <div class="col-span-full mt-6 mb-3 first:mt-0">
                                                        <h3 class="text-2xl font-bold text-[#330000] border-b-2 border-gray-200 pb-2 letter-header">{firstLetter}</h3>
                                                    </div>
                                                )}
                                                <div class="group hover:bg-gray-50 p-3 rounded-xl transition-all duration-300 cursor-pointer category-item">
                                                    <p class="text-gray-600 group-hover:text-[#B22222] transition-colors duration-300 text-base">{category}</p>
                                                    <div class="w-0 group-hover:w-full h-0.5 bg-gradient-to-r from-[#B22222] to-[#330000] transition-all duration-300 opacity-0 group-hover:opacity-100"></div>
                                                </div>
                                            </>
                                        );
                                    })}
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </section>
    </main>

    {/* CTA Section */}
    <CTA />

    <Footer />
</Layout>

<style>
    .shadow-3xl {
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }

    .custom-scrollbar {
        scrollbar-width: thin;
        scrollbar-color: #E5E7EB transparent;
    }

    .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
    }

    .custom-scrollbar::-webkit-scrollbar-track {
        background: transparent;
    }

    .custom-scrollbar::-webkit-scrollbar-thumb {
        background-color: #E5E7EB;
        border-radius: 3px;
    }

    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background-color: #D1D5DB;
    }

    /* Dropdown Animations */
    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-10px);
            max-height: 0;
        }
        to {
            opacity: 1;
            transform: translateY(0);
            max-height: 600px;
        }
    }

    @keyframes slideUp {
        from {
            opacity: 1;
            transform: translateY(0);
            max-height: 600px;
        }
        to {
            opacity: 0;
            transform: translateY(-10px);
            max-height: 0;
        }
    }

    .dropdown-enter {
        animation: slideDown 0.5s ease-out forwards;
    }

    .dropdown-exit {
        animation: slideUp 0.4s ease-in forwards;
    }

    .category-item {
        opacity: 0;
        transform: translateY(10px);
        transition: all 0.3s ease-out;
    }

    .category-item.show {
        opacity: 1;
        transform: translateY(0);
    }

    .letter-header {
        opacity: 0;
        transform: translateX(-10px);
        transition: all 0.3s ease-out;
    }

    .letter-header.show {
        opacity: 1;
        transform: translateX(0);
    }

    @keyframes slideUp {
        0% {
            opacity: 0;
            transform: translateY(50px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .scroll-animate-up {
        will-change: transform, opacity;
        opacity: 0;
        transform: translateY(50px);
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .initial-fade {
        animation: fadeIn 1s ease-out forwards;
    }

    @keyframes slideUp {
        0% {
            opacity: 0;
            transform: translateY(50px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .scroll-animate-up {
        will-change: transform, opacity;
        opacity: 0;
        transform: translateY(50px);
    }

    .clip-path-custom {
        clip-path: polygon(0% 15%, 15% 0%, 85% 0%, 100% 15%, 100% 85%, 85% 100%, 15% 100%, 0% 85%);
    }

    .clip-path-custom2 {
        clip-path: polygon(5% 0%, 95% 0%, 100% 25%, 100% 75%, 95% 100%, 5% 100%, 0% 75%, 0% 25%);
    }

    .clip-path-custom3 {
        clip-path: polygon(10% 0%, 90% 0%, 100% 20%, 100% 80%, 90% 100%, 10% 100%, 0% 80%, 0% 20%);
    }
</style>

<script>
    // Categories toggle functionality
    const toggleButton = document.getElementById('toggleCategories');
    const categoriesList = document.getElementById('categoriesList');
    const arrowIcon = document.getElementById('arrowIcon');

    // Function to close dropdown
    const closeDropdown = (shouldScroll = false) => {
        if (!categoriesList?.classList.contains('hidden')) {
            animateCategories(false);
            setTimeout(() => {
                categoriesList?.classList.add('hidden');
                arrowIcon?.classList.remove('rotate-180');
                
                // Only scroll back if explicitly requested (when toggle button is clicked)
                if (shouldScroll && toggleButton) {
                    const specialisedSection = toggleButton.closest('section');
                    if (specialisedSection) {
                        const sectionRect = specialisedSection.getBoundingClientRect();
                        const scrollPosition = window.pageYOffset + sectionRect.top - 100;
                        window.scrollTo({
                            top: scrollPosition,
                            behavior: 'smooth'
                        });
                    }
                }
            }, 300);
        }
    };

    // Function to open dropdown and scroll to content
    const openDropdown = () => {
        categoriesList?.classList.remove('hidden');
        arrowIcon?.classList.add('rotate-180');
        animateCategories(true);

        // Wait for the dropdown to be visible and animations to start
        setTimeout(() => {
            if (categoriesList && toggleButton) {
                const buttonRect = toggleButton.getBoundingClientRect();
                const dropdownRect = categoriesList.getBoundingClientRect();
                
                // Calculate position that shows both button and content
                const targetPosition = window.pageYOffset + buttonRect.top - 100; // Keep button visible with some padding
                
                window.scrollTo({
                    top: targetPosition,
                    behavior: 'smooth'
                });
            }
        }, 100);
    };

    // Toggle button click handler
    toggleButton?.addEventListener('click', (e) => {
        e.stopPropagation(); // Prevent click from immediately triggering document click
        if (categoriesList?.classList.contains('hidden')) {
            openDropdown();
        } else {
            closeDropdown(true); // Pass true to scroll back when toggle button is clicked
        }
    });

    // Click outside to close
    document.addEventListener('click', (e) => {
        if (!categoriesList?.contains(e.target as Node) && 
            !toggleButton?.contains(e.target as Node) && 
            !categoriesList?.classList.contains('hidden')) {
            closeDropdown(false); // Pass false to prevent scrolling when clicking outside
        }
    });

    // Prevent clicks inside dropdown from closing it
    categoriesList?.addEventListener('click', (e) => {
        e.stopPropagation();
    });

    // Close on escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !categoriesList?.classList.contains('hidden')) {
            closeDropdown(false); // Pass false to prevent scrolling when using escape key
        }
    });

    function animateCategories(show: boolean) {
        const letterHeaders = document.querySelectorAll<HTMLElement>('.letter-header');
        const categoryItems = document.querySelectorAll<HTMLElement>('.category-item');

        if (show) {
            letterHeaders.forEach((header, index) => {
                setTimeout(() => {
                    header.classList.add('show');
                }, index * 100);
            });

            categoryItems.forEach((item, index) => {
                setTimeout(() => {
                    item.classList.add('show');
                }, Math.floor(index / 4) * 50 + 200);
            });
        } else {
            letterHeaders.forEach(header => header.classList.remove('show'));
            categoryItems.forEach(item => item.classList.remove('show'));
        }
    }

    // Add hover effect for category items
    document.querySelectorAll<HTMLElement>('.group').forEach(item => {
        item.addEventListener('mouseenter', () => {
            item.style.transform = 'translateY(-2px)';
        });
        
        item.addEventListener('mouseleave', () => {
            item.style.transform = 'translateY(0)';
        });
    });

    // Scroll animation
    let lastScrollTop = 0;
    let isScrollingDown = true;

    // Update scroll direction
    window.addEventListener('scroll', () => {
        const currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
        isScrollingDown = currentScrollTop > lastScrollTop;
        lastScrollTop = currentScrollTop;
    });

    // Scroll animation for content sections and CTA
    const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            const element = entry.target as HTMLElement;
            
            if (entry.isIntersecting) {
                if (isScrollingDown) {
                    element.style.animation = 'slideUp 0.8s ease-out forwards';
                } else {
                    element.style.opacity = '1';
                    element.style.transform = 'translateY(0)';
                }
            } else if (!entry.isIntersecting && !isScrollingDown) {
                element.style.animation = 'none';
                element.style.opacity = '0';
                element.style.transform = 'translateY(50px)';
            }
        });
    }, observerOptions);

    document.addEventListener('DOMContentLoaded', () => {
        // Observe sections
        const sections = document.querySelectorAll('.mb-16 > div, .py-16 > div, .scroll-animate-up');
        sections.forEach((section, index) => {
            if (index > 0) {
                const element = section as HTMLElement;
                element.classList.add('scroll-animate-up');
                
                const rect = element.getBoundingClientRect();
                const isInViewport = rect.top < window.innerHeight;
                
                if (isInViewport) {
                    element.style.opacity = '1';
                    element.style.transform = 'translateY(0)';
                } else {
                    element.style.opacity = '0';
                    element.style.transform = 'translateY(50px)';
                }
                
                element.style.transition = 'transform 0.8s ease-out, opacity 0.8s ease-out';
                observer.observe(element);
            }
        });

        // Add initial fade in effect
        const heroSection = document.querySelector('.pt-32');
        if (heroSection) {
            heroSection.classList.add('initial-fade');
        }
    });
</script> 